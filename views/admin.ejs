<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>YÃ¶netim Paneli</title>

<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;600;800&display=swap" rel="stylesheet">

<style>
:root{
  --gold:#f5c77a;
  --red:#b30000;
  --black:#0b0b0b;
  --glass:rgba(255,255,255,0.06);
}

*{box-sizing:border-box}

body{
  margin:0;
  font-family:'Orbitron',sans-serif;
  background:
    radial-gradient(circle at top,#1a0000,#000),
    repeating-linear-gradient(45deg,rgba(255,0,0,.03),rgba(255,0,0,.03) 10px,transparent 10px,transparent 20px);
  color:#fff;
  padding:30px;
  animation:bgMove 20s linear infinite;
}

@keyframes bgMove{
  from{background-position:0 0}
  to{background-position:400px 400px}
}

.container{
  max-width:1200px;
  margin:auto;
}

/* KART */
.card{
  background:linear-gradient(145deg,rgba(0,0,0,.85),rgba(40,0,0,.9));
  border:1px solid rgba(255,215,150,.2);
  border-radius:18px;
  padding:25px;
  margin-bottom:35px;
  box-shadow:
    0 0 25px rgba(255,0,0,.25),
    inset 0 0 30px rgba(255,215,150,.08);
  backdrop-filter:blur(10px);
  animation:cardGlow 4s ease-in-out infinite alternate;
}

@keyframes cardGlow{
  from{box-shadow:0 0 15px rgba(255,0,0,.3)}
  to{box-shadow:0 0 35px rgba(255,215,150,.4)}
}

/* HEADER */
.header-row{
  display:flex;
  justify-content:space-between;
  align-items:center;
  border-bottom:1px solid rgba(255,215,150,.3);
  padding-bottom:15px;
  margin-bottom:20px;
}

h1{
  margin:0;
  font-size:1.8rem;
  color:var(--gold);
  text-shadow:0 0 10px rgba(255,215,150,.6);
}

h2{
  color:#ffb3b3;
  margin-bottom:15px;
  border-bottom:1px dashed rgba(255,0,0,.4);
  padding-bottom:5px;
}

/* BUTONLAR */
.backup-actions{display:flex;gap:12px}

.btn-backup{
  padding:10px 18px;
  border-radius:30px;
  font-weight:700;
  border:1px solid rgba(255,215,150,.5);
  background:linear-gradient(135deg,#300,#600);
  color:var(--gold);
  cursor:pointer;
  text-decoration:none;
  transition:.3s;
  box-shadow:0 0 15px rgba(255,0,0,.5);
}

.btn-backup:hover{
  transform:translateY(-2px) scale(1.05);
  box-shadow:0 0 30px rgba(255,215,150,.9);
}

/* FORM */
.form-row{
  display:flex;
  gap:15px;
  flex-wrap:wrap;
  align-items:flex-end;
}

.form-group{
  display:flex;
  flex-direction:column;
}

label{
  font-size:.75rem;
  color:#ffcccc;
  margin-bottom:4px;
}

input,select{
  background:rgba(0,0,0,.6);
  border:1px solid rgba(255,215,150,.4);
  color:#fff;
  padding:10px;
  border-radius:8px;
  transition:.3s;
}

input:focus,select:focus{
  outline:none;
  box-shadow:0 0 15px rgba(255,215,150,.7);
}

button{
  padding:10px 22px;
  background:linear-gradient(135deg,#700,#d40000);
  border:none;
  border-radius:25px;
  color:#fff;
  font-weight:800;
  cursor:pointer;
  box-shadow:0 0 20px rgba(255,0,0,.7);
  transition:.3s;
}

button:hover{
  transform:scale(1.08);
  box-shadow:0 0 35px rgba(255,215,150,1);
}

.update-btn{
  padding:8px 16px;
  font-size:.85rem;
}

/* TABLO */
table{
  width:100%;
  border-collapse:collapse;
}

th{
  background:linear-gradient(135deg,#400,#800);
  color:var(--gold);
  padding:12px;
}

td{
  padding:14px;
  border-bottom:1px solid rgba(255,255,255,.1);
}

tr{
  transition:.3s;
}

tr:hover{
  background:rgba(255,0,0,.08);
  box-shadow:inset 0 0 15px rgba(255,215,150,.15);
}

.link{
  color:var(--gold);
  text-decoration:none;
  text-shadow:0 0 8px rgba(255,215,150,.7);
}
</style>
</head>

<body>

<div class="container">

<div class="card">
  <div class="header-row">
    <h1>ðŸ’Ž Kargo YÃ¶netim Paneli</h1>
    <div class="backup-actions">
      <a href="/admin/backup?secret=<%= secret %>" class="btn-backup">ðŸ’¾ YedeÄŸi Ä°ndir</a>
      <button onclick="document.getElementById('fileInput').click()" class="btn-backup">ðŸ“‚ Yedek YÃ¼kle</button>
      <input type="file" id="fileInput" style="display:none" accept=".json" onchange="yedekYukle(this)">
    </div>
  </div>
  <p>Toplam KayÄ±t: <strong><%= items.length %></strong></p>
</div>

<div class="card">
<h2>âž• Yeni Kargo OluÅŸtur</h2>
<form action="/admin/create" method="POST">
<input type="hidden" name="secret" value="<%= secret %>">
<div class="form-row">
  <div class="form-group" style="flex:1">
    <label>Takip No</label>
    <input name="id">
  </div>
  <div class="form-group" style="flex:2">
    <label>AlÄ±cÄ±</label>
    <input name="full_name" required>
  </div>
  <div class="form-group" style="flex:2">
    <label>Adres</label>
    <input name="address" required>
  </div>
  <div class="form-group">
    <label>Tarih</label>
    <input name="eta" value="<%= new Date().toISOString().split('T')[0] %>">
  </div>
  <button>OluÅŸtur</button>
</div>
</form>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Kargo</th>
<th>Durum</th>
<th>Tarih</th>
<th>Ä°ÅŸlem</th>
</tr>
</thead>
<tbody>
<% items.forEach(function(item){ %>
<tr>
<form action="/admin/update" method="POST">
<input type="hidden" name="secret" value="<%= secret %>">
<input type="hidden" name="id" value="<%= item.id %>">
<td>
<a class="link" href="/t/<%= item.id %>" target="_blank">#<%= item.id %></a><br>
<strong><%= item.full_name %></strong><br>
<small><%= item.address %></small>
</td>
<td>
<select name="status">
<option <%= item.status==='HazÄ±rlandÄ±'?'selected':'' %>>HazÄ±rlandÄ±</option>
<option <%= item.status==='Yola Ã§Ä±ktÄ±'?'selected':'' %>>Yola Ã§Ä±ktÄ±</option>
<option <%= item.status==='DaÄŸÄ±tÄ±mda'?'selected':'' %>>DaÄŸÄ±tÄ±mda</option>
<option <%= item.status==='Teslim edildi'?'selected':'' %>>Teslim edildi</option>
</select>
</td>
<td><input name="eta" value="<%= item.eta %>" style="width:100px"></td>
<td><button class="update-btn">Kaydet</button></td>
</form>
</tr>
<% }) %>
</tbody>
</table>
</div>

</div>

<script>
function yedekYukle(input){
 if(!input.files[0])return;
 const r=new FileReader();
 r.onload=e=>{
  const d=JSON.parse(e.target.result);
  if(!confirm(d.length+" kayÄ±t yÃ¼klenecek. Emin misin?"))return;
  fetch('/admin/restore',{
   method:'POST',
   headers:{'Content-Type':'application/json'},
   body:JSON.stringify({secret:"<%= secret %>",data:d})
  }).then(()=>location.reload());
 };
 r.readAsText(input.files[0]);
}
</script>

</body>
</html>
